\section{Extended Kalman filter}
\index{Nonlinear control!extended Kalman filter}
\index{State-space observers!Extended Kalman filter}

In this book, we have covered the Kalman filter, which is the optimal unbiased
estimator for linear \glspl{system}. It isn't optimal for nonlinear
\glspl{system}, but several extensions to it have been developed to make it more
accurate.

The extended Kalman filter \glslink{linearization}{linearizes} the matrices used
during the prediction step. $\mtx{A}$, $\mtx{B}$, $\mtx{C}$, and $\mtx{D}$ are
\glslink{linearization}{linearized} as follows:

\begin{align*}
  \mtx{A} &\approx
    \frac{\partial f(\mtx{x}, \mtx{u})}{\partial \mtx{x}} &
  \mtx{B} &\approx
    \frac{\partial f(\mtx{x}, \mtx{u})}{\partial \mtx{u}} &
  \mtx{C} &\approx
    \frac{\partial h(\mtx{x}, \mtx{u})}{\partial \mtx{x}} &
  \mtx{D} &\approx
    \frac{\partial h(\mtx{x}, \mtx{u})}{\partial \mtx{u}}
\end{align*}

From there, the continuous Kalman filter equations are used like normal to
compute the error covariance matrix $\mtx{P}$ and Kalman gain matrix. The
\gls{state} estimate update can still use the function $h(\mtx{x})$ for
accuracy.

\begin{equation*}
  \hat{\mtx{x}}_{k+1}^+ = \hat{\mtx{x}}_{k+1}^- +
    \mtx{K}_{k+1}(\mtx{y}_{k+1} - h(\hat{\mtx{x}}_{k+1}^-))
\end{equation*}
